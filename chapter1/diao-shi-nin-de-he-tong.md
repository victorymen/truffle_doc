# 调试您的合约

Truffle包含一个集成的调试器，以便您可以调试针对您的合同进行的交易。此调试器的外观和感觉类似于传统开发环境中可用的现有命令行调试程序。

## 概观

调试区块链上的事务与调试传统应用程序（例如，用C ++或Javascript编写的应用程序）不同。在区块链上调试事务时，您没有实时运行代码;相反，您将逐步执行该事务的历史执行，并将该执行映射到其关联的代码上。这为调试提供了许多自由，因为我们可以随时调试任何事务，只要我们拥有事务与之交互的契约的代码和工件即可。将这些代码和工件视为类似于传统调试器所需的调试符号。

要调试事务，您需要以下内容：

* truffle4.0或以上。
* 您所需区块链上的交易哈希值。
* 事务遇到的源代码和工件。

请注意，如果您所需的交易导致异常或者燃气耗尽，那也没关系。事务仍然存在于链上，因此您仍然可以调试它！

## 命令

要使用调试器，请收集您要调试的事务，然后运行以下命令：

```
$ truffle debug <transaction hash>
```

使用以`0x8e5dadfb921dd...`示例开头的事务，该命令将如下所示：

```
$ truffle debug 0x8e5dadfb921ddddfa8f53af1f9bd8beeac6838d52d7e0c2fe5085b42a4f3ca76
```

## 调试界面

启动调试器将打开熟悉已调试其他类型应用程序的接口。当它启动时，您将看到以下内容：

* 在此交易过程中处理或创建的地址列表。
* 用于使用调试器的可用命令列表。
* 并且是交易的初始入口点，包括合同源文件和代码预览。

该`enter`键设置为执行最后输入的命令。当调试器启动时，`enter`键被设置为步进到执行期间遇到的下一个逻辑源代码元素（即，由以太坊虚拟机评估的下一个表达式或语句）。此时，您可以按此`enter`按钮逐步执行事务，或输入一个可用命令以更详细地分析事务。命令列表详述如下。

### \(o\) step over

此命令相对于当前在Solidity源文件中计算的语句或表达式的位置，逐步调整当前行。如果您不想在当前行上进入函数调用或合同创建，或者您想快速跳转到源文件中的特定点，请使用此命令。

### \(i\) step into

此命令进入当前正在评估的函数调用或合同创建。使用此命令跳转到该函数并快速开始调试其中存在的代码。

### \(u\) step out

此命令退出当前运行的功能。如果这是事务的入口点，请使用此命令快速返回到调用函数，或结束事务的执行。

### \(n\) step next

此命令将执行源代码中的下一个逻辑语句或表达式。例如，在虚拟机可以评估完整表达式之前，需要首先评估子表达式。如果要分析虚拟机评估的每个逻辑项，请使用此命令。

### \(;\) step instruction

此命令允许您逐步执行虚拟机评估的每个单独指令。如果您有兴趣了解Solidity源代码创建的低级字节码，这将非常有用。使用此命令时，调试器还将在评估指令时打印出堆栈数据。

### \(p\) print instruction

此命令打印当前指令和堆栈数据，但不会跳到下一条指令。当您希望在使用上述逻辑命令导航事务之后查看当前指令和堆栈数据时，请使用此选项。

### \(h\) print this help

打印可用命令列表。

### \(q\) quit

退出调试器。

